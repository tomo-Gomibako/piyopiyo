{"changed":false,"filter":false,"title":"index_7-1.js","tooltip":"/index_7/index_7-1.js","value":"var fs = require(\"fs\");\nvar Handlebars = require(\"handlebars\");\nvar express = require(\"express\");\nvar app = express();\n\nvar bodyParser = require(\"body-parser\");\napp.use(bodyParser.urlencoded({extended: true}));\n\nfunction makeTemplate(fileName){\n    var source = fs.readFileSync(fileName).toString();\n    var template = Handlebars.compile(source);\n    return template;\n}\n\n\nvar source = fs.readFileSync(\"root.html\").toString();\nvar template = Handlebars.compile(source);\n\napp.get(\"/\", function(req, res){\n    var context = {\n        result: source,\n    };\n    var html = template(context);\n    res.send(html);\n});\n\n\nvar sourceQ1 = fs.readFileSync(\"q1.html\").toString();\nvar templateQ1 = Handlebars.compile(sourceQ1);\n\napp.get(\"/q1\", function(req, res){\n    var context = {\n        result: sourceQ1,\n    };\n    var html = templateQ1(context);\n    res.send(html);\n});\n\n\nvar sourceQ1sub = fs.readFileSync(\"q1sub.html\").toString();\nvar templateQ1sub = Handlebars.compile(sourceQ1sub);\n\napp.get(\"/q1/sub\", function(req, res){\n    var context = {\n        result: sourceQ1sub,\n    };\n    var html = templateQ1sub(context);\n    res.send(html);\n});\n\n\nvar sourceQ2 = fs.readFileSync(\"q2.html\").toString();\nvar templateQ2 = Handlebars.compile(sourceQ2);\n\napp.get(\"/q2\", function(req, res){\n    var context = {\n        result: sourceQ2,\n    };\n    var html = templateQ2(context);\n    res.send(html);\n});\n\napp.get(\"/q2/:srg\", function(req, res){\n    var html = \"<p>Hi,\" + req.params.srg + \"!</p>\";\n    res.send(html);\n});\n\napp.get(\"/q3\", function(req, res){\n    var template = makeTemplate(\"q3.html\");\n    var html = template({\n        /*送受信するもの？*/\n    });\n    res.send(html);\n});\n\napp.get(\"/q3/date\", function(req, res){\n    var template = makeTemplate(\"q3.html\");\n    var date = new Date().toString();\n    var html = template({\n        date: date,\n    });\n    res.send(html);\n});\n\napp.get(\"/q4\", function(req, res){\n    var template = makeTemplate(\"q4.html\");\n    var date = new Date().toString();\n    var html = template({\n        date: date,\n    });\n    res.send(html);\n});\n\nvar accessQ5 = 0;\napp.get(\"/q5\", function(req, res){\n    accessQ5++;\n    var template = makeTemplate(\"q5.html\");\n    var html = template({\n        accessQ5: accessQ5,\n    });\n    res.send(html);\n});\n\napp.get(\"/q6\", function(req, res){\n    var template = makeTemplate(\"q6.html\");\n    var kotae = Number(req.query.tasareru) + Number(req.query.tasu);\n    var html = template({\n        kotae: kotae,\n    });\n    // console.log(req.query.tasareru);\n    res.send(html);\n});\n\n\nfunction date(){\n    var hoho = new Date().getHours() + 9;   //.getHoursは0~23\n    if(hoho > 23){\n        var hour = hoho - 24;\n    }else{\n        var hour = hoho;\n    }\n    // console.log(hour);\n    var minu = new Date().getMinutes();\n    if(minu < 10){\n        var mnts = \"0\" + minu.toString();\n    }else{\n        var mnts = minu.toString();\n    }\n    // console.log(minu);\n    var date = hour.toString() + \":\" + mnts;\n    return date;\n}\nvar historyArray = [];\nvar history = \"\";\napp.get(\"/q7\", function(req, res){\n    var template = makeTemplate(\"q7.html\");\n    if(req.query.send){\n        historyArray.push(req.query.message + \"-----\" + date());\n        // historyArray.push(\"<br>\");\n    }else if(req.query.clear){\n        historyArray = [];\n    }else if(req.query.replace){\n        var num = Number(req.query.number);\n        var replace = req.query.replaceText;\n        historyArray[num - 1] = replace + \"-----\" + date();\n    }\n    history = \"\";\n    historyArray.forEach(function(v, i){\n        history += (i + 1).toString() + \" : \" + v + \"<br>\";\n    });\n\n    var html = template({\n        history: history,\n    });\n    res.send(html + history);\n});\n\n\nfunction janken(num){\n    if(num == 1){return \" ぐー \"}\n    if(num == 2){return \"ちょき\"}\n    if(num == 3){return \" ぱー \"}\n}\napp.get(\"/q8\", function(req, res){\n    var template = makeTemplate(\"q8.html\");\n    var select = 0;\n    var win = \"お前の負けだ！\";\n    var lose = \"お前の勝ちだ！\";\n    var result = \"\";\n    var difficulty = 5;\n    \n    if(req.query.guu || req.query.cho || req.query.paa){\n        if(req.query.guu){\n            select = 1;\n        }else if(req.query.cho){\n            select = 2;\n        }else if(req.query.paa){\n            select = 3;\n        }\n        var player = \"あなたの選択: \" + janken(select);\n        \n        if(req.query.mode == 1){\n            var probability = Math.floor(Math.random() * difficulty) + 1;\n            if(probability == 1){\n                var cpu = Math.floor(Math.random() * 3) + 1;\n            }\n            if(select == 3){cpu = 1;}\n            else if(select == 1){cpu = 2;}\n            else if(select == 2){cpu = 3;}\n        }\n        if(req.query.mode == 2){\n            var cpu = Math.floor(Math.random() * 3) + 1;\n        }\n        if(req.query.mode == 3){\n            var probability = Math.floor(Math.random() * difficulty) + 1;\n            if(probability == 1){\n                var cpu = Math.floor(Math.random() * 3) + 1;\n            }\n            if(select == 3){cpu = 2;}\n            else if(select == 1){cpu = 3;}\n            else if(select == 2){cpu = 1;}\n        }\n        var computer = \"コンピュータ: \" + janken(cpu);\n        \n        if(select == cpu){\n            result = \"あいこだ！\";\n        }else if(select == 1 && cpu == 2){\n            result = lose;\n        }else if(select == 2 && cpu == 3){\n            result = lose;\n        }else if(select == 3 && cpu == 1){\n            result = lose;\n        }else{\n            result = win;\n        }\n    }\n    var html = template({\n        player: player,\n        computer: computer,\n        result: result,\n    });\n    res.send(html);\n});\n\napp.listen(process.env.PORT || 3000);","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"customSyntax":"javascript","scrolltop":1059,"scrollleft":0,"selection":{"start":{"row":128,"column":25},"end":{"row":128,"column":25},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":65,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1465626276000}